---
export const prerender = true

import { getCollection } from 'astro:content';
import DefaultPageLayout from '$/layouts/default.astro'
import { toSlug } from 'src/utils';

let title = 'All Tags'
let description = 'All the tags used so far...'


const allPosts = await getCollection('blog');
const tags = [...new Set<string>([].concat.apply([], allPosts.map(post => post.data.tags)))]
const techs = [...new Set<string>([].concat.apply([], allPosts.map(post => post.data.techs ?? [])))]

tags.sort()
techs.sort()

---

<DefaultPageLayout content={{ title, description }}>
    <div class="flex flex-col gap-8">

        <ul class="tag-list">
         {tags.map((tag) => (
            <li><a class="tag" href={`/tags/${toSlug(tag)}`} title={`View posts tagged under "${tag}"`}>{tag}</a></li>
        ))}
        </ul>
        
        <h1 class="page__title">Sort by technology</h1>
        
        
        <ul class="tag-list">
            {techs.map((tech) => (
               <li><a class="tag" href={`/tags/${toSlug(tech)}`} title={`View posts tagged under "${tech}"`}>{tech}</a></li>
           ))}
           </ul>
    </div>
</DefaultPageLayout>

<style>
    .page__title {
        @apply text-3xl font-extrabold text-theme-primary dark:text-theme-dark-primary
    }
    .tag-list {
        @apply list-none flex gap-2 flex-wrap
    }
    .tag {
        @apply inline-block text-xl px-4 py-1 rounded-full text-theme-primary bg-theme-dark-primary dark:bg-theme-primary dark:text-theme-dark-primary hover:bg-theme-primary hover:text-theme-dark-primary dark:hover:bg-theme-dark-primary dark:hover:text-theme-primary
    }
</style>
